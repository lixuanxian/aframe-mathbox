{"version":3,"sources":["binder.js","api.js","bootstrap.js","plugin.js","aliases.js","fallback.js","renderer.js","bind.js","size.js","fill.js","loop.js","time.js","scene.js","camera.js","render.js","warmup.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA;AACA;AACA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"build/threestrap-core.js","sourcesContent":["THREE.Binder = {\n  bind: function (context, globals) {\n    return function (key, object) {\n\n      // Prepare object\n      if (!object.__binds) {\n        object.__binds = [];\n      }\n\n      // Set base target\n      var fallback = context;\n      if (_.isArray(key)) {\n        fallback = key[0];\n        key = key[1];\n      }\n\n      // Match key\n      var match = /^([^.:]*(?:\\.[^.:]+)*)?(?:\\:(.*))?$/.exec(key);\n      var path = match[1].split(/\\./g);\n\n      var name = path.pop();\n      var dest = match[2] || name;\n\n      // Whitelisted objects\n      var selector = path.shift();\n      var target = {\n        'this': object,\n      }[selector] || globals[selector] || context[selector] || fallback;\n\n      // Look up keys\n      while (target && (key = path.shift())) { target = target[key] };\n\n      // Attach event handler at last level\n      if (target && (target.on || target.addEventListener)) {\n        var callback = function (event) {\n          object[dest] && object[dest](event, context);\n        };\n\n        // Polyfill for both styles of event listener adders\n        THREE.Binder._polyfill(target, [ 'addEventListener', 'on' ], function (method) {\n          target[method](name, callback);\n        });\n\n        // Store bind for removal later\n        var bind = { target: target, name: name, callback: callback };\n        object.__binds.push(bind);\n\n        // Return callback\n        return callback;\n      }\n      else {\n        throw \"Cannot bind '\" + key + \"' in \" + this.__name;\n      }\n    };\n  },\n\n  unbind: function () {\n    return function (object) {\n      // Remove all binds belonging to object\n      if (object.__binds) {\n\n        object.__binds.forEach(function (bind) {\n\n          // Polyfill for both styles of event listener removers\n          THREE.Binder._polyfill(bind.target, [ 'removeEventListener', 'off' ], function (method) {\n            bind.target[method](bind.name, bind.callback);\n          });\n        }.bind(this));\n\n        object.__binds = [];\n      }\n    }\n  },\n\n  apply: function ( object ) {\n\n    Object.assign( object, THREE.EventDispatcher.prototype );\n\n    object.trigger     = THREE.Binder._trigger;\n    object.triggerOnce = THREE.Binder._triggerOnce;\n\n    object.on = object.addEventListener;\n    object.off = object.removeEventListener;\n    object.dispatchEvent = object.trigger;\n\n  },\n\n  ////\n\n  _triggerOnce: function (event) {\n    this.trigger(event);\n    if (this._listeners) {\n      delete this._listeners[event.type]\n    }\n  },\n\n  _trigger: function (event) {\n\n    if (this._listeners === undefined) return;\n\n    var type = event.type;\n    var listeners = this._listeners[type];\n    if (listeners !== undefined) {\n\n      listeners = listeners.slice()\n      var length = listeners.length;\n\n      event.target = this;\n      for (var i = 0; i < length; i++) {\n        // add original target as parameter for convenience\n        listeners[i].call(this, event, this);\n      }\n    }\n  },\n\n  _polyfill: function (object, methods, callback) {\n    methods.map(function (method) { return object.method });\n    if (methods.length) callback(methods[0]);\n  },\n\n};","THREE.Api = {\n  apply: function (object) {\n\n    object.set = function (options) {\n      var o = this.options || {};\n\n      // Diff out changes\n      var changes = _.reduce(options, function (result, value, key) {\n        if (o[key] !== value) result[key] = value;\n        return result;\n      }, {});\n\n      this.options = _.extend(o, changes);\n\n      // Notify\n      this.trigger({ type: 'change', options: options, changes: changes });\n    };\n\n    object.get = function () {\n      return this.options;\n    };\n\n    object.api = function (object, context) {\n      object = object || {};\n\n      // Append context argument to API methods\n      context && _.each(object, function (callback, key, object) {\n        if (_.isFunction(callback)) {\n          object[key] = _.partialRight(callback, context);\n        }\n      })\n\n      object.set = this.set.bind(this);\n      object.get = this.get.bind(this);\n\n      return object;\n    };\n\n  },\n};","THREE.Bootstrap = function (options) {\n  if (options) {\n    var args = [].slice.apply(arguments);\n    options = {};\n\n    // (element, ...)\n    if (args[0] instanceof Node) {\n      node = args[0];\n      args = args.slice(1);\n\n      options.element = node;\n    }\n\n    // (..., plugin, plugin, plugin)\n    if (_.isString(args[0])) {\n      options.plugins = args;\n    }\n\n    // (..., [plugin, plugin, plugin])\n    if (_.isArray(args[0])) {\n      options.plugins = args[0];\n    }\n\n    // (..., options)\n    if (args[0]) {\n      options = _.defaults(options, args[0]);\n    }\n  }\n\n  // 'new' is optional\n  if (!(this instanceof THREE.Bootstrap)) return new THREE.Bootstrap(options);\n\n  // Apply defaults\n  var defaults = {\n    init: true,\n    element: document.body,\n    plugins: ['core'],\n    aliases: {},\n    plugindb: THREE.Bootstrap.Plugins || {},\n    aliasdb: THREE.Bootstrap.Aliases || {},\n  };\n  this.__options = _.defaults(options || {}, defaults);\n\n  // Hidden state\n  this.__inited = false;\n  this.__destroyed = false;\n  this.__installed = [];\n\n  // Query element\n  var element = this.__options.element;\n  if (element === '' + element) {\n    element = document.querySelector(element);\n  }\n\n  // Global context\n  this.plugins = {};\n  this.element = element;\n\n  // Auto-init\n  if (this.__options.init) {\n    this.init();\n  }\n};\n\nTHREE.Bootstrap.prototype = {\n\n  init: function () {\n    if (this.__inited) return;\n    this.__inited = true;\n\n    // Install plugins\n    this.install(this.__options.plugins);\n\n    return this;\n  },\n\n  destroy: function () {\n    if (!this.__inited) return;\n    if (this.__destroyed) return;\n    this.__destroyed = true;\n\n    // Notify of imminent destruction\n    this.trigger({ type: 'destroy' });\n\n    // Then uninstall plugins\n    this.uninstall();\n\n    return this;\n  },\n\n  resolve: function (plugins) {\n    plugins = _.isArray(plugins) ? plugins : [plugins];\n\n    // Resolve alias database\n    var o = this.__options;\n    var aliases = _.extend({}, o.aliasdb, o.aliases);\n\n    // Remove inline alias defs from plugins\n    var filter = function (name) {\n      var key = name.split(':');\n      if (!key[1]) return true;\n      aliases[key[0]] = [key[1]];\n      return false;\n    };\n    plugins = _.filter(plugins, filter);\n\n    // Unify arrays\n    _.each(aliases, function (alias, key) {\n      aliases[key] = _.isArray(alias) ? alias : [alias];\n    });\n\n    // Look up aliases recursively\n    function recurse(list, out, level) {\n      if (level >= 256) throw \"Plug-in alias recursion detected.\";\n      list = _.filter(list, filter);\n      _.each(list, function (name) {\n        var alias = aliases[name];\n        if (!alias) {\n          out.push(name);\n        }\n        else {\n          out = out.concat(recurse(alias, [], level + 1));\n        }\n      });\n      return out;\n    }\n\n    return recurse(plugins, [], 0);\n  },\n\n  install: function (plugins) {\n    plugins = _.isArray(plugins) ? plugins : [plugins];\n\n    // Resolve aliases\n    plugins = this.resolve(plugins);\n\n    // Install in order\n    _.each(plugins, this.__install, this);\n\n    // Fire off ready event\n    this.__ready();\n  },\n\n  uninstall: function (plugins) {\n    if (plugins) {\n      plugins = _.isArray(plugins) ? plugins : [plugins];\n\n      // Resolve aliases\n      plugins = this.resolve(plugins);\n    }\n\n    // Uninstall in reverse order\n    _.eachRight(plugins || this.__installed, this.__uninstall, this);\n  },\n\n  __install: function (name) {\n    // Sanity check\n    var ctor = this.__options.plugindb[name];\n    if (!ctor) throw \"[three.install] Cannot install. '\" + name + \"' is not registered.\";\n    if (this.plugins[name]) return console.warn(\"[three.install] \"+ name + \" is already installed.\");\n\n    // Construct\n    var Plugin = ctor;\n    var plugin = new Plugin(this.__options[name] || {}, name);\n    this.plugins[name] = plugin;\n\n    // Install\n    flag = plugin.install(this);\n    this.__installed.push(plugin);\n\n    // Then notify\n    this.trigger({ type: 'install', plugin: plugin });\n\n    // Allow early abort\n    return flag;\n  },\n\n  __uninstall: function (name, alias) {\n    // Sanity check\n    plugin = _.isString(name) ? this.plugins[name] : name;\n    if (!plugin) return console.warn(\"[three.uninstall] \" + name + \"' is not installed.\");\n    name = plugin.__name;\n\n    // Uninstall\n    plugin.uninstall(this);\n    this.__installed = _.without(this.__installed, plugin);\n    delete this.plugins[name];\n\n    // Then notify\n    this.trigger({ type: 'uninstall', plugin: plugin });\n  },\n\n  __ready: function () {\n    // Notify and remove event handlers\n    this.triggerOnce({ type: 'ready' });\n  },\n\n};\n\nTHREE.Binder.apply(THREE.Bootstrap.prototype);\n\n","THREE.Bootstrap.Plugins = {};\nTHREE.Bootstrap.Aliases = {};\n\nTHREE.Bootstrap.Plugin = function (options) {\n  this.options = _.defaults(options || {}, this.defaults);\n}\n\nTHREE.Bootstrap.Plugin.prototype = {\n\n  listen: [],\n\n  defaults: {},\n\n  install: function (three) {\n\n  },\n\n  uninstall: function (three) {\n  },\n\n  ////////\n\n};\n\nTHREE.Binder.apply(THREE.Bootstrap.Plugin.prototype);\nTHREE.Api   .apply(THREE.Bootstrap.Plugin.prototype);\n\nTHREE.Bootstrap.registerPlugin = function (name, spec) {\n  var ctor = function (options) {\n    THREE.Bootstrap.Plugin.call(this, options);\n    this.__name = name;\n  };\n  ctor.prototype = _.extend(new THREE.Bootstrap.Plugin(), spec);\n\n  THREE.Bootstrap.Plugins[name] = ctor;\n}\n\nTHREE.Bootstrap.unregisterPlugin = function (name) {\n  delete THREE.Bootstrap.Plugins[name];\n}\n\nTHREE.Bootstrap.registerAlias = function (name, plugins) {\n  THREE.Bootstrap.Aliases[name] = plugins;\n}\n\nTHREE.Bootstrap.unregisterAlias = function (name) {\n  delete THREE.Bootstrap.Aliases[name];\n}\n","THREE.Bootstrap.registerAlias('empty', ['fallback', 'bind', 'renderer', 'size', 'fill', 'loop', 'time']);\nTHREE.Bootstrap.registerAlias('core', ['empty', 'scene', 'camera', 'render', 'warmup']);\nTHREE.Bootstrap.registerAlias('VR', ['core', 'cursor', 'fullscreen', 'render:vr']);","THREE.Bootstrap.registerPlugin('fallback', {\n\n  defaults: {\n    force:   false,\n    fill:    true,\n    begin:   '<div class=\"threestrap-fallback\" style=\"display: table; width: 100%; height: 100%;'+\n             'box-sizing: border-box; border: 1px dashed rgba(0, 0, 0, .25);\">'+\n             '<div style=\"display: table-cell; padding: 10px; vertical-align: middle; text-align: center;\">',\n    end:     '</div></div>',\n    message: '<big><strong>This example requires WebGL</strong></big><br>'+\n             'Visit <a target=\"_blank\" href=\"http://get.webgl.org/\">get.webgl.org</a> for more info</a>',\n  },\n\n  install: function (three) {\n    var cnv;\n    try {\n      cnv = document.createElement('canvas');\n      gl = cnv.getContext('webgl') || cnv.getContext('experimental-webgl');\n      if (!gl || this.options.force) {\n        throw \"WebGL unavailable.\";\n      }\n      three.fallback = false;\n    }\n    catch (e) {\n      var message = this.options.message;\n      var begin   = this.options.begin;\n      var end     = this.options.end;\n      var fill    = this.options.fill;\n\n      var div = document.createElement('div');\n      div.innerHTML = begin + message + end;\n\n      this.children = []\n\n      while (div.childNodes.length > 0) {\n        this.children.push(div.firstChild);\n        three.element.appendChild(div.firstChild);\n      }\n\n      if (fill) {\n        three.install('fill');\n      }\n\n      this.div = div;\n      three.fallback = true;\n      return false; // Abort install\n    }\n  },\n\n  uninstall: function (three) {\n    if (this.children) {\n      this.children.forEach(function (child) {\n        child.parentNode.removeChild(child);\n      });\n      this.children = null\n    }\n\n    delete three.fallback;\n  },\n\n});","THREE.Bootstrap.registerPlugin('renderer', {\n\n  defaults: {\n    klass: THREE.WebGLRenderer,\n    parameters: {\n      depth: true,\n      stencil: true,\n      preserveDrawingBuffer: true,\n      antialias: true,\n    },\n  },\n\n  listen: ['resize'],\n\n  install: function (three) {\n    // Instantiate Three renderer\n    var renderer = three.renderer = new this.options.klass(this.options.parameters);\n    three.canvas = renderer.domElement;\n\n    // Add to DOM\n    three.element.appendChild(renderer.domElement);\n  },\n\n  uninstall: function (three) {\n    // Remove from DOM\n    three.element.removeChild(three.renderer.domElement);\n\n    delete three.renderer;\n    delete three.canvas;\n  },\n\n  resize: function (event, three) {\n    var renderer = three.renderer;\n    var el = renderer.domElement;\n\n    // Resize renderer to render size if it's a canvas\n    if (el && el.tagName == 'CANVAS') {\n      renderer.setSize(event.renderWidth, event.renderHeight, false);\n    }\n    // Or view size if it's just a DOM element or multi-renderer\n    else {\n      if (renderer.setRenderSize) {\n        renderer.setRenderSize(event.renderWidth, event.renderHeight);\n      }\n      renderer.setSize(event.viewWidth, event.viewHeight, false);\n    }\n  },\n\n});\n","THREE.Bootstrap.registerPlugin('bind', {\n\n  install: function (three) {\n    var globals = {\n      'three': three,\n      'window': window,\n    };\n\n    three.bind = THREE.Binder.bind(three, globals);\n    three.unbind = THREE.Binder.unbind(three);\n\n    three.bind('install:bind', this);\n    three.bind('uninstall:unbind', this);\n  },\n\n  uninstall: function (three) {\n    three.unbind(this);\n\n    delete three.bind;\n    delete three.unbind;\n  },\n\n  bind: function (event, three) {\n    var plugin = event.plugin;\n    var listen = plugin.listen;\n\n    listen && listen.forEach(function (key) {\n      three.bind(key, plugin);\n    });\n  },\n\n  unbind: function (event, three) {\n    three.unbind(event.plugin);\n  },\n\n});\n","THREE.Bootstrap.registerPlugin('size', {\n\n  defaults: {\n    width: null,\n    height: null,\n    aspect: null,\n    scale: 1,\n    maxRenderWidth: Infinity,\n    maxRenderHeight: Infinity,\n    devicePixelRatio: true,\n  },\n\n  listen: [\n    'window.resize:queue',\n    'element.resize:queue',\n    'this.change:queue',\n    'ready:resize',\n    'pre:pre',\n  ],\n\n  install: function (three) {\n\n    three.Size = this.api({\n      renderWidth: 0,\n      renderHeight: 0,\n      viewWidth: 0,\n      viewHeight: 0,\n    });\n\n    this.resized = false;\n  },\n\n  uninstall: function (three) {\n    delete three.Size;\n  },\n\n  queue: function (event, three) {\n    this.resized = true;\n  },\n\n  pre: function (event, three) {\n    if (!this.resized) return;\n    this.resized = false;\n    this.resize(event, three);\n  },\n\n  resize: function (event, three) {\n    var options = this.options;\n    var element = three.element;\n    var renderer = three.renderer;\n\n    var w, h, ew, eh, rw, rh, aspect, cut, style, ratio,\n        ml = 0 , mt = 0;\n\n    // Measure element\n    w = ew = (options.width === undefined || options.width == null)\n      ? element.offsetWidth || element.innerWidth || 0\n      : options.width;\n\n    h = eh = (options.height === undefined || options.height == null)\n      ? element.offsetHeight || element.innerHeight || 0\n      : options.height;\n\n    // Force aspect ratio\n    aspect = w / h;\n    if (options.aspect) {\n      if (options.aspect > aspect) {\n        h = Math.round(w / options.aspect);\n        mt = Math.floor((eh - h) / 2);\n      }\n      else {\n        w = Math.round(h * options.aspect);\n        ml = Math.floor((ew - w) / 2);\n      }\n      aspect = w / h;\n    }\n\n    // Get device pixel ratio\n    ratio = 1\n    if (options.devicePixelRatio && typeof window != 'undefined') {\n      ratio = window.devicePixelRatio || 1\n    }\n\n    // Apply scale and resolution max\n    rw = Math.min(w * ratio * options.scale, options.maxRenderWidth);\n    rh = Math.min(h * ratio * options.scale, options.maxRenderHeight);\n\n    // Retain aspect ratio\n    raspect = rw / rh;\n    if (raspect > aspect) {\n      rw = Math.round(rh * aspect);\n    }\n    else {\n      rh = Math.round(rw / aspect);\n    }\n\n    // Measure final pixel ratio\n    ratio = rh / h\n\n    // Resize and position renderer element\n    style = renderer.domElement.style;\n    style.width = w + \"px\";\n    style.height = h + \"px\";\n    style.marginLeft = ml + \"px\";\n    style.marginTop = mt + \"px\";\n\n    // Notify\n    _.extend(three.Size, {\n      renderWidth: rw,\n      renderHeight: rh,\n      viewWidth: w,\n      viewHeight: h,\n      aspect: aspect,\n      pixelRatio: ratio,\n    });\n\n    three.trigger({\n      type: 'resize',\n      renderWidth: rw,\n      renderHeight: rh,\n      viewWidth: w,\n      viewHeight: h,\n      aspect: aspect,\n      pixelRatio: ratio,\n    });\n  },\n\n});","THREE.Bootstrap.registerPlugin('fill', {\n\n  defaults: {\n    block: true,\n    body: true,\n    layout: true,\n  },\n\n  install: function (three) {\n\n    function is(element) {\n      var h = element.style.height;\n      return h == 'auto' || h == '';\n    }\n\n    function set(element) {\n      element.style.height = '100%';\n      element.style.margin = 0;\n      element.style.padding = 0;\n      return element;\n    }\n\n    if (this.options.body && three.element == document.body) {\n      // Fix body height if we're naked\n      this.applied =\n        [ three.element, document.documentElement ].filter(is).map(set);\n    }\n\n    if (this.options.block && three.canvas) {\n      three.canvas.style.display = 'block'\n      this.block = true;\n    }\n\n    if (this.options.layout && three.element) {\n      var style = window.getComputedStyle(three.element);\n      if (style.position == 'static') {\n        three.element.style.position = 'relative';\n        this.layout = true;\n      }\n    }\n\n  },\n\n  uninstall: function (three) {\n    if (this.applied) {\n      function set(element) {\n        element.style.height = '';\n        element.style.margin = '';\n        element.style.padding = '';\n        return element;\n      }\n\n      this.applied.map(set);\n      delete this.applied;\n    }\n\n    if (this.block && three.canvas) {\n      three.canvas.style.display = '';\n      delete this.block;\n    }\n\n    if (this.layout && three.element) {\n      three.element.style.position = '';\n      delete this.layout;\n    }\n  },\n\n  change: function (three) {\n    this.uninstall(three);\n    this.install(three);\n  },\n\n});\n","THREE.Bootstrap.registerPlugin('loop', {\n\n  defaults: {\n    start: true,\n  },\n\n  listen: ['ready'],\n\n  install: function (three) {\n\n    this.running = false;\n\n    three.Loop = this.api({\n      start: this.start.bind(this),\n      stop: this.stop.bind(this),\n      running: false,\n    }, three);\n\n    this.events =\n      ['pre', 'update', 'render', 'post'].map(function (type) {\n        return { type: type };\n      });\n\n  },\n\n  uninstall: function (three) {\n    this.stop(three);\n  },\n\n  ready: function (event, three) {\n    if (this.options.start) this.start(three);\n  },\n\n  start: function (three) {\n    if (this.running) return;\n\n    three.Loop.running = this.running = true;\n\n    var trigger = three.trigger.bind(three);\n    var loop = function () {\n      this.running && requestAnimationFrame(loop);\n      this.events.map(trigger);\n    }.bind(this);\n\n    requestAnimationFrame(loop);\n\n    three.trigger({ type: 'start' });\n  },\n\n  stop: function (three) {\n    if (!this.running) return;\n    three.Loop.running = this.running = false;\n\n    three.trigger({ type: 'stop' });\n  },\n\n});","THREE.Bootstrap.registerPlugin('time', {\n\n  defaults: {\n    speed: 1,  // Clock speed\n    warmup: 0, // Wait N frames before starting clock\n    timeout: 1 // Timeout in seconds. Pause if no tick happens in this time.\n  },\n\n  listen: ['pre:tick', 'this.change'],\n\n  now: function () {\n    return +new Date() / 1000\n  },\n\n  install: function (three) {\n\n    three.Time = this.api({\n      now: this.now(), // Time since 1970 in seconds\n\n      clock: 0,        // Adjustable clock that counts up from 0 seconds\n      step:  1/60,     // Clock step in seconds\n\n      frames: 0,       // Framenumber\n      time: 0,         // Real time in seconds\n      delta: 1/60,     // Frame step in seconds\n\n      average: 0,      // Average frame time in seconds\n      fps: 0,          // Average frames per second\n    });\n\n    this.last  = 0;\n    this.time  = 0;\n    this.clock = 0;\n    this.wait  = this.options.warmup;\n\n    this.clockStart = 0;\n    this.timeStart  = 0;\n  },\n\n  tick: function (event, three) {\n    var speed = this.options.speed;\n    var timeout = this.options.timeout;\n\n    var api = three.Time;\n    var now = api.now = this.now();\n    var last = this.last;\n    var time = this.time;\n    var clock = this.clock;\n\n    if (last) {\n      var delta   = api.delta = now - last;\n      var average = api.average || delta;\n\n      if (delta > timeout) {\n        delta = 0;\n      }\n\n      var step = delta * speed;\n\n      time  += delta;\n      clock += step;\n\n      if (api.frames > 0) {\n        api.average = average + (delta - average) * .1;\n        api.fps = 1 / average;\n      }\n\n      api.step  = step;\n      api.clock = clock - this.clockStart;\n      api.time  = time  - this.timeStart;\n\n      api.frames++;\n\n      if (this.wait-- > 0) {\n        this.clockStart = clock;\n        this.timeStart  = time;\n        api.clock = 0;\n        api.step  = 1e-100;\n      }\n    }\n\n    this.last   = now;\n    this.clock  = clock;\n    this.time   = time;\n  },\n\n  uninstall: function (three) {\n    delete three.Time;\n  },\n\n});","THREE.Bootstrap.registerPlugin('scene', {\n\n  install: function (three) {\n    three.scene = new THREE.Scene();\n  },\n\n  uninstall: function (three) {\n    delete three.scene;\n  }\n\n});","THREE.Bootstrap.registerPlugin('camera', {\n\n  defaults: {\n    near: .01,\n    far: 10000,\n\n    type: 'perspective',\n    fov: 60,\n    aspect: null,\n\n    // type: 'orthographic',\n    left: -1,\n    right: 1,\n    bottom: -1,\n    top: 1,\n\n    klass: null,\n    parameters: null,\n  },\n\n  listen: ['resize', 'this.change'],\n\n  install: function (three) {\n\n    three.Camera = this.api();\n    three.camera = null;\n\n    this.aspect = 1;\n    this.change({}, three);\n  },\n\n  uninstall: function (three) {\n    delete three.Camera;\n    delete three.camera;\n  },\n\n  change: function (event, three) {\n    var o = this.options;\n    var old = three.camera;\n\n    if (!three.camera || event.changes.type || event.changes.klass) {\n      var klass = o.klass ||\n      {\n        'perspective': THREE.PerspectiveCamera,\n        'orthographic': THREE.OrthographicCamera,\n      }[o.type] || THREE.Camera;\n\n      three.camera = o.parameters ? new klass(o.parameters) : new klass();\n    }\n\n    _.each(o, function (value, key) {\n      if (three.camera.hasOwnProperty(key)) three.camera[key] = o[key];\n    }.bind(this));\n\n    this.update(three);\n\n    (old === three.camera) || three.trigger({\n      type: 'camera',\n      camera: three.camera,\n    });\n  },\n\n  resize: function (event, three) {\n    this.aspect = event.viewWidth / Math.max(1, event.viewHeight);\n\n    this.update(three);\n  },\n\n  update: function (three) {\n    three.camera.aspect = this.options.aspect || this.aspect;\n    three.camera.updateProjectionMatrix();\n  },\n\n});","THREE.Bootstrap.registerPlugin('render', {\n\n  listen: ['render'],\n\n  render: function (event, three) {\n    if (three.scene && three.camera) {\n      three.renderer.render(three.scene, three.camera,null);\n    }\n  },\n\n});","THREE.Bootstrap.registerPlugin('warmup', {\n\n  defaults: {\n    delay: 2,\n  },\n\n  listen: ['ready', 'post'],\n\n  ready: function (event, three) {\n    three.renderer.domElement.style.visibility = 'hidden'\n    this.frame = 0;\n    this.hidden = true;\n  },\n\n  post: function (event, three) {\n    if (this.hidden && this.frame >= this.options.delay) {\n      three.renderer.domElement.style.visibility = 'visible'\n      this.hidden = false;\n    }\n    this.frame++;\n  },\n\n});"],"sourceRoot":"/source/"}